{% extends 'base.html' %}
{% load static %}
{% block body_class %}fase-1{% endblock %}
{% block content %}
<div data-js="progress" data-step="1" data-total="4">
  <div class="progress"><div class="progress__bar"></div></div>
  <div class="progress__label"></div>
</div>
<h2>ğŸª™ Etapa 1 â€” O Vale das OperaÃ§Ãµes (SOMA, SUBTRAÃ‡ÃƒO, MÃ‰DIA, MÃXIMO, MÃNIMO)</h2>

<!-- âœ¨ Abertura: gancho emocional e contexto -->
<section class="bloco teoria destaque">
  <h3>âœ¨ Por que isso importa?</h3>
  <p>Se o Excel fosse um superpoder, <strong>as operaÃ§Ãµes bÃ¡sicas</strong> seriam sua forÃ§a inicial.
    Ã‰ com elas que vocÃª soma suas vitÃ³rias, entende suas mÃ©dias, descobre seus recordes
    (maior e menor valor) e dÃ¡ o primeiro passo rumo a decisÃµes melhores.<br>
    <em>Hoje vocÃª destrava o â€œPoder da Planilhaâ€ â€” rÃ¡pido, bonito e Ãºtil.</em></p>

  <div class="grid-2">
    <div>
      <h4>ğŸ§­ Objetivo da etapa</h4>
      <ul class="check">
        <li>Aplicar: <br>=SOMA, <br>=SUBTRAÃ‡ÃƒO <br>=MÃ‰DIA <br>=MÃXIMO <br>=MÃNIMO</li>
        <li>Formatar nÃºmeros como dinheiro e destacar resultados automaticamente.</li>
        <li>Construir um mini-painel do mÃªs em menos de 15 minutos.</li>
      </ul>
    </div>
    <div>
      <h4>âŒ¨ï¸ Atalhos ninja (Windows)</h4>
      <ul class="tips">
        <li><kbd>Alt</kbd> + <kbd>=</kbd> â†’ AutoSoma (insere <code>=SOMA(...)</code>)</li>
        <li><kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>$</kbd> â†’ Moeda</li>
        <li><kbd>Ctrl</kbd> + <kbd>;</kbd> â†’ Inserir data</li>
        <li><kbd>Ctrl</kbd> + <kbd>C</kbd> / <kbd>Ctrl</kbd> + <kbd>V</kbd> â†’ Copiar/colar fÃ³rmulas</li>
      </ul>
    </div>
  </div>
 </section>

<div class="bloco desafio callout warning" >
  <h3>âš¡ Checagem RÃ¡pida</h3>
  <div class="grid-2">
    <!-- Pergunta 1 -->
    <form data-js="quiz" data-correct="SOMA" onsubmit="return false;">
      <fieldset>
        <legend>Qual fÃ³rmula <strong>soma</strong> o intervalo <code>B2:B7</code>?</legend>
        <div style="margin-top:8px;">
          <label><input type="radio" name="q1" value="SOMA"> =SOMA(B2:B7)</label><br>
          <label><input type="radio" name="q1" value="MEDIA"> =MÃ‰DIA(B2:B7)</label>
        </div>
        <div data-js="feedback"></div>
      </fieldset>
    </form>
    <!-- Pergunta 2 -->
    <form data-js="quiz" data-correct="MAXIMO" onsubmit="return false;">
      <fieldset>
        <legend>Qual fÃ³rmula acha o <strong>maior valor</strong> no intervalo?</legend>
        <div style="margin-top:8px;">
          <label><input type="radio" name="q2" value="MINIMO"> =MÃNIMO(B2:B7)</label><br>
          <label><input type="radio" name="q2" value="MAXIMO"> =MÃXIMO(B2:B7)</label>
        </div>
        <div data-js="feedback"></div>
      </fieldset>
    </form>
  </div>
</div>

<!-- ğŸ“˜ Teoria resumida e visual -->
<section class="bloco teoria">
  <h3>ğŸ“˜ Teoria em 60 segundos</h3>
  <div class="grid-2">
    <div>
      <ul class="code-bullets">
        <li>â• Soma: <code>=SOMA(B2:B7)</code></li>
        <li>â– SubtraÃ§Ã£o: <code>=B2-B3</code></li>
        <li>ğŸ“Š MÃ©dia: <code>=MÃ‰DIA(B2:B7)</code></li>
        <li>â¬†ï¸ MÃ¡ximo: <code>=MÃXIMO(B2:B7)</code></li>
        <li>â¬‡ï¸ MÃ­nimo: <code>=MÃNIMO(B2:B7)</code></li>
      </ul>
      <p class="hint">Dica: use intervalos (ex.: <code>B2:B7</code>) em vez de somar cÃ©lula por cÃ©lula. Ã‰ mais rÃ¡pido, limpo e evita erros.</p>
    </div>
    <div class="callout info">
      <strong>Erros comuns:</strong>
      <ul>
        <li>Usar vÃ­rgula em vez de ponto nas fÃ³rmulas (Excel PT-BR usa <em>;</em> para separar argumentos).</li>
        <li>Somar cÃ©lulas com texto â€œR$ 100â€ (formate como nÃºmero/moeda, nÃ£o texto).</li>
        <li>Selecionar linhas a mais ou a menos no intervalo.</li>
      </ul>
    </div>
  </div>
</section>

<!-- ğŸ§  Exemplo guiado (passo a passo visual) -->
<section class="bloco exemplo">
  <h3>ğŸ§  Exemplo guiado: â€œReceitas do mÃªsâ€</h3>
  <p>Monte esta tabelinha (ou copie a ideia) e aplique as fÃ³rmulas:</p>

  <table>
    <tr><th>Fonte</th><th>Valor (R$)</th></tr>
    <tr><td>SalÃ¡rio</td><td>2500</td></tr>
    <tr><td>Freelance</td><td>800</td></tr>
    <tr><td>Venda</td><td>400</td></tr>
    <tr><td>Presente</td><td>150</td></tr>
  </table>

  <div class="grid-2">
    <div>
      <h4>ğŸ”¢ FÃ³rmulas principais</h4>
      <pre><code>
Total .......... =SOMA(B2:B5)<br>
SubtraÃ§Ã£o ...... =B2-B3<br>
MÃ©dia .......... =MÃ‰DIA(B2:B5)<br>
Maior valor .... =MÃXIMO(B2:B5)<br>
Menor valor .... =MÃNIMO(B2:B5)
      </code></pre>
    </div>
    <div class="callout success">
      <strong>Polimento em 30s:</strong>
      <ul>
        
        <li>Selecione valores <kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>$</kbd></li>
        <li>Negrito no Total <kbd>Ctrl</kbd> + <kbd>B</kbd></li>
        <li>AutoSoma no Total: <kbd>Alt +=</kbd></li>
      </ul>
    </div>
  </div>
</section>

<!-- ğŸ’ª Desafio prÃ¡tico com gamificaÃ§Ã£o -->
<section class="bloco desafio">
  <h3>ğŸ’ª MÃ£o na massa: Mini Painel â€œMÃªs 1â€</h3>
  <p>Crie duas tabelas: <strong>Receitas</strong> e <strong>Despesas</strong>. Depois, monte um resumo com 5 indicadores.</p>

  <div class="callout info" style="margin-top: 16px;">
    <strong>ğŸ“¦ Dataset Sugerido:</strong> <a href="{% static 'datasets/despesas_de_casa.xls' %}" class="btn-next" download style="margin:0; padding: 6px 10px; font-size: .9rem;">Baixar base</a><br>
    <strong>MissÃ£o:</strong> Monte o painel â€˜MÃªs 1â€™ com total, mÃ©dia, maior/menor e saldo. BÃ´nus: semÃ¡foro no saldo.
  </div>

  <div class="grid-2">
    <div>
      <h4>ğŸ“¥ Receitas</h4>
      <ul class="plain">
        <li>3 a 5 entradas (ex.: salÃ¡rio, extra, vendas)</li>
        <li>Formate tudo como moeda</li>
      </ul>
      <h4>ğŸ“¤ Despesas</h4>
      <ul class="plain">
        <li>5 a 8 itens (ex.: aluguel, mercado, transporteâ€¦)</li>
        <li>Formate tudo como moeda</li>
      </ul>
    </div>
    <div>
      <h4>ğŸ“Œ Indicadores (cÃ©lulas separadas)</h4>
      <pre><code>
Total Receitas ... =SOMA(intervalo_receitas)
Total Despesas ... =SOMA(intervalo_despesas)
Saldo ............ =Total_Receitas-Total_Despesas
Maior Despesa .... =MÃXIMO(intervalo_despesas)
Menor Despesa .... =MÃNIMO(intervalo_despesas)
      </code></pre>
      <p class="hint">Destaque o <strong>Saldo</strong> com borda grossa e fundo suave.</p>
    </div>
  </div>

  <div class="callout warning">
    <strong>Desafio bÃ´nus (2 min):</strong> Aplique <em>FormataÃ§Ã£o Condicional</em> no Saldo:
    <ul>
      <li>Verde se &gt;= 0</li>
      <li>Vermelho se &lt; 0</li>
    </ul>
  </div>

  <div class="badges">
    <span class="badge">ğŸ… AutoSoma Pro</span>
    <span class="badge">ğŸ’ Painel Limpo</span>
    <span class="badge">âš¡ Atalhos Ninja</span>
  </div>

  <div class="callout success" style="margin-top: 20px;">
    <h4>ğŸ“¤ Envie seu trabalho</h4>
    <form method="post" action="{% url 'submit_etapa' %}" enctype="multipart/form-data">
      {% csrf_token %}
      <input type="hidden" name="etapa_id" value="f1e1">
      <label for="planilha_f1e1">Selecione sua planilha:</label>
      <input type="file" name="planilha" id="planilha_f1e1" required>
      <button type="submit" class="btn-submit">Submeter Planilha</button>
    </form>
  </div>
</section>

<!-- ğŸï¸ Modo Turbo (para encantar os avanÃ§ados sem assustar iniciantes) -->
<section class="bloco extra">
  <h3>ğŸï¸ Modo Turbo (opcional)</h3>
  <div class="grid-2">
    <div class="callout info">
      <strong>AutoSoma Inteligente</strong><br>
      Insira linhas no meio da tabela e perceba como o <code>=SOMA()</code> se ajusta.
      Se nÃ£o ajustar, altere o intervalo para incluir novos itens (ou transforme a Ã¡rea em <em>Tabela</em>).
    </div>
    <div class="callout info">
      <strong>Tabela dinÃ¢mica (seed)</strong><br>
      Converta suas listas em â€œTabelaâ€ (Ctrl + T). Ela mantÃ©m formataÃ§Ã£o, cria filtros e expande fÃ³rmulas automaticamente.
    </div>
  </div>
</section>

<!-- âœ… Checklist de encerramento -->
<section class="bloco teoria">
  <h3>âœ… Checklist â€” pronto para avanÃ§ar?</h3>
  <ul class="check">
    <li>Usei SOMA, subtraÃ§Ã£o, MÃ‰DIA, MÃXIMO e MÃNIMO.</li>
    <li>Formatei como moeda e destaquei o Saldo.</li>
    <li>Montei um mini-painel com 5 indicadores.</li>
    <li>Testei AutoSoma e, se possÃ­vel, Tabela (Ctrl + T).</li>
  </ul>
  <p class="hint">Se tudo ok, vocÃª estÃ¡ preparado(a) para a lÃ³gica do <strong>SE()</strong> na Etapa 2.</p>
</section>

<a href="{% url 'etapa2' %}" class="btn-next">Ir para Etapa 2 (SE, E, OU) â¡ï¸</a>
{% endblock %}
