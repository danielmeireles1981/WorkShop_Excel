{% extends 'base.html' %}
{% block content %}
<h2>ğŸ° Etapa 4 â€” Castelo das Buscas (PROCV, PROCH, CORRESP + ÃNDICE)</h2>

<!-- âœ¨ Abertura motivacional -->
<section class="bloco teoria destaque">
  <h3>âœ¨ Encontrar respostas como quem tem um â€œorÃ¡culoâ€</h3>
  <p>Chegou a hora de conectar ilhas de dados. Com as funÃ§Ãµes de <strong>busca</strong>, sua planilha
     encontra informaÃ§Ãµes automaticamente e transforma tabelas em <em>sistemas</em> â€” catÃ¡logos, listas de preÃ§os,
     dicionÃ¡rios de categorias, metas por grupoâ€¦ tudo interligado.</p>

  <div class="grid-2">
    <div>
      <h4>ğŸ¯ Objetivos da etapa</h4>
      <ul class="check">
        <li>Buscar dados com <strong>PROCV</strong> (vertical) e <strong>PROCH</strong> (horizontal).</li>
        <li>Entender <strong>CORRESP</strong> (posiÃ§Ã£o) e <strong>ÃNDICE</strong> (valor pela posiÃ§Ã£o).</li>
        <li>Montar um mini-sistema de consulta (cÃ³digo â†’ nome, preÃ§o, categoria).</li>
      </ul>
    </div>
    <div>
      <h4>ğŸ’¡ Quando usar qual?</h4>
      <ul class="tips">
        <li><strong>PROCV</strong>: chave na 1Âª coluna, retorna de outra coluna.</li>
        <li><strong>PROCH</strong>: chave na 1Âª linha, retorna de outra linha.</li>
        <li><strong>CORRESP+ÃNDICE</strong>: busca <em>flexÃ­vel</em> (chave em qualquer coluna/linha).</li>
      </ul>
    </div>
  </div>
</section>

<!-- ğŸ“˜ Teoria express -->
<section class="bloco teoria">
  <h3>ğŸ“˜ Teoria em 90 segundos</h3>
  <div class="grid-2">
    <div>
      <ul class="code-bullets">
        <li>ğŸ” PROCV: <code>=PROCV(valor; tabela; num_coluna; FALSO)</code></li>
        <li>ğŸ§­ PROCH: <code>=PROCH(valor; tabela; num_linha; FALSO)</code></li>
        <li>ğŸ“ CORRESP: <code>=CORRESP(valor; intervalo; 0)</code> â†’ retorna a <em>posiÃ§Ã£o</em></li>
        <li>ğŸ“¦ ÃNDICE: <code>=ÃNDICE(intervalo; linha; [coluna])</code> â†’ retorna o <em>valor</em></li>
      </ul>
      <p class="hint">â€œExatoâ€ = usar <code>FALSO</code> (nÃ£o aproximado). Em <code>CORRESP</code>, use <code>0</code> para correspondÃªncia exata.</p>
    </div>
    <div class="callout info">
      <strong>Erros comuns</strong>
      <ul>
        <li>Chave de busca <em>nÃ£o</em> estar na primeira coluna (PROCV) / primeira linha (PROCH).</li>
        <li>Usar <code>VERDADEIRO</code> (aproximado) sem a tabela estar ordenada.</li>
        <li>Mesclar cÃ©lulas na base (evite â€” quebre mesclas em bases de dados).</li>
      </ul>
    </div>
  </div>
</section>

<!-- ğŸ§  Exemplo guiado -->
<section class="bloco exemplo">
  <h3>ğŸ§  Exemplo guiado: â€œCatÃ¡logo de Produtosâ€</h3>
  <p>Monte a base (ou use algo similar):</p>

  <table>
    <tr><th>CÃ³digo</th><th>Produto</th><th>Categoria</th><th>PreÃ§o</th></tr>
    <tr><td>101</td><td>Mouse</td><td>PerifÃ©ricos</td><td>60</td></tr>
    <tr><td>102</td><td>Teclado</td><td>PerifÃ©ricos</td><td>120</td></tr>
    <tr><td>103</td><td>Monitor</td><td>Displays</td><td>800</td></tr>
  </table>

  <div class="grid-2">
    <div>
      <h4>ğŸ”¢ PROCV clÃ¡ssico</h4>
      <pre><code>
# Buscar nome pelo cÃ³digo (ex.: cÃ³digo em G2)
=PROCV(G2; A2:D4; 2; FALSO)   # Produto
=PROCV(G2; A2:D4; 3; FALSO)   # Categoria
=PROCV(G2; A2:D4; 4; FALSO)   # PreÃ§o
      </code></pre>
      <p class="hint">A chave (cÃ³digo) estÃ¡ na primeira coluna (A). Por isso o PROCV funciona.</p>
    </div>
    <div class="callout success">
      <h4>ğŸ” CORRESP + ÃNDICE (flexÃ­vel)</h4>
      <pre><code>
# Coluna do "PreÃ§o" (dinÃ¢mica, se o cabeÃ§alho mudar de lugar)
=CORRESP("PreÃ§o"; A1:D1; 0)          â†’ retorna, por ex., 4

# Valor do preÃ§o do produto com cÃ³digo em G2
=ÃNDICE(A2:D4; CORRESP(G2; A2:A4; 0); CORRESP("PreÃ§o"; A1:D1; 0))
      </code></pre>
      <p class="hint">Essa dupla funciona mesmo se as colunas mudarem de ordem. Mais robusto para â€œsistemasâ€.</p>
    </div>
  </div>
</section>

<!-- ğŸ’ª Desafio gamificado -->
<section class="bloco desafio">
  <h3>ğŸ’ª MÃ£o na massa: â€œSistema de Consulta RÃ¡pidaâ€</h3>
  <p>Crie uma Ã¡rea de consulta onde o usuÃ¡rio digita um <strong>cÃ³digo</strong> e recebe automaticamente:</p>

  <div class="grid-2">
    <div>
      <h4>ğŸ“Œ SaÃ­das obrigatÃ³rias</h4>
      <ul class="plain">
        <li>Produto (nome)</li>
        <li>Categoria</li>
        <li>PreÃ§o</li>
      </ul>
      <p>Implemente com <strong>PROCV</strong> e depois refaÃ§a com <strong>CORRESP+ÃNDICE</strong>.</p>
    </div>
    <div>
      <h4>ğŸš¦ ValidaÃ§Ãµes e feedback</h4>
      <ul class="plain">
        <li>Se o cÃ³digo nÃ£o existir â†’ exiba â€œ<em>NÃ£o encontrado</em>â€.</li>
        <li>Se o preÃ§o &gt;= 500 â†’ destaque em laranja (â€œalto valorâ€).</li>
      </ul>
      <pre><code>
# Exibir "NÃ£o encontrado" quando der erro
=SE(Ã‰ERROS(PROCV(G2;A2:D4;2;FALSO));"NÃ£o encontrado";
   PROCV(G2;A2:D4;2;FALSO))
      </code></pre>
    </div>
  </div>

  <div class="badges">
    <span class="badge">ğŸ… Mestre do PROCV</span>
    <span class="badge">ğŸ§© CORRESP + ÃNDICE</span>
    <span class="badge">ğŸ›¡ï¸ Base Robusta</span>
  </div>
</section>

<!-- ğŸï¸ Modo Turbo -->
<section class="bloco extra">
  <h3>ğŸï¸ Modo Turbo (opcional)</h3>
  <div class="grid-2">
    <div class="callout info">
      <strong>PROCH em matriz horizontal</strong><br>
      Se a base vier â€œdeitadaâ€ (tÃ­tulos na coluna A e valores em linha), use:<br>
      <code>=PROCH(chave; matriz; num_linha; FALSO)</code><br>
      *Dica:* Avalie se faz sentido transpor a base para o formato â€œcolunarâ€ (mais comum).
    </div>
    <div class="callout info">
      <strong>Metas por categoria (spoiler de dashboards)</strong><br>
      Crie uma tabela de metas (Categoria, Meta_R$) e busque a meta da categoria:<br>
      <code>=ÃNDICE(Metas!B:B; CORRESP(Categoria; Metas!A:A; 0))</code><br>
      Compare Real x Meta com <code>SE()</code> e semÃ¡foros.
    </div>
  </div>
</section>

<!-- âœ… Checklist -->
<section class="bloco teoria">
  <h3>âœ… Checklist â€” concluiu a Fase 1?</h3>
  <ul class="check">
    <li>Busquei dados com <strong>PROCV</strong> (exato) e/ou <strong>PROCH</strong>.</li>
    <li>Implementei a versÃ£o <strong>CORRESP+ÃNDICE</strong> (mais flexÃ­vel).</li>
    <li>Montei um <strong>Sistema de Consulta</strong> com feedback para erro.</li>
    <li>Dei um toque visual (formataÃ§Ã£o condicional). </li>
  </ul>
  <p class="hint">Se tudo ok, vocÃª fechou a <strong>Fase 1</strong>. Bora desbloquear a <strong>Fase 2 â€” FinanÃ§as Pessoais</strong>! ğŸ’°</p>
</section>

<div style="display:flex; gap:10px; flex-wrap:wrap;">
  <a href="/game/" class="btn-next">ğŸ Voltar ao Mapa do Jogo</a>
  <a href="{% url 'fase2_etapa1' %}" class="btn-next">â–¶ï¸ Iniciar Fase 2</a>
</div>
{% endblock %}
